{"ast":null,"code":"import{useEffect}from'react';import{Controller,useFormContext}from'react-hook-form';import{useDispatch,useSelector}from'react-redux';import{useLocation}from'react-router-dom';import Select from'react-select';import{getExpensesCategory,getIncomeCategory,getSid}from'Redux/kapustaSlice';import{getExpenseCategories,getIncomeCategories}from'Redux/transactionOperation';import{ErrorMessage,ErrorPositionWrapper}from'../DescriptionInput/DescriptionInput.styled';import{colourStyles}from'./CategoryInput.styled';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";export default function CategoryInput(){var _errors$category;var _useLocation=useLocation(),pathname=_useLocation.pathname;var dispatch=useDispatch();var expensCategory=useSelector(getExpensesCategory);var incomeCategory=useSelector(getIncomeCategory);var sid=useSelector(getSid);useEffect(function(){if(sid&&pathname==='/home/expenses')dispatch(getExpenseCategories());if(sid&&pathname==='/home/income')dispatch(getIncomeCategories());},[dispatch,pathname,sid]);var _useFormContext=useFormContext(),control=_useFormContext.control,errors=_useFormContext.formState.errors;var categories=function categories(){if(pathname==='/home/expenses')return expensCategory===null||expensCategory===void 0?void 0:expensCategory.map(function(i){return{label:i,value:i};});if(pathname==='/home/income')return incomeCategory===null||incomeCategory===void 0?void 0:incomeCategory.map(function(i){return{label:i,value:i};});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(ErrorPositionWrapper,{children:[/*#__PURE__*/_jsx(Controller,{control:control,name:\"category\",render:function render(_ref){var _ref$field=_ref.field,_onChange=_ref$field.onChange,value=_ref$field.value,ref=_ref$field.ref;return/*#__PURE__*/_jsx(Select,{ref:ref,styles:colourStyles,placeholder:'Product category',options:categories(),value:value?categories().find(function(c){return c.value===value;}):null,onChange:function onChange(val){return _onChange(val.value);}});}}),(errors===null||errors===void 0?void 0:errors.category)&&/*#__PURE__*/_jsx(ErrorMessage,{children:(errors===null||errors===void 0?void 0:(_errors$category=errors.category)===null||_errors$category===void 0?void 0:_errors$category.message)||'Error!'})]})});}","map":{"version":3,"names":["useEffect","Controller","useFormContext","useDispatch","useSelector","useLocation","Select","getExpensesCategory","getIncomeCategory","getSid","getExpenseCategories","getIncomeCategories","ErrorMessage","ErrorPositionWrapper","colourStyles","CategoryInput","pathname","dispatch","expensCategory","incomeCategory","sid","control","errors","formState","categories","map","i","label","value","field","onChange","ref","find","c","val","category","message"],"sources":["/Users/serhiimaistrenko/react/Kapusta-smart-finance/src/components/Expenses/Form/Inputs/CategoryInput/CategoryInput.jsx"],"sourcesContent":["import { useEffect } from 'react';\nimport { Controller, useFormContext } from 'react-hook-form';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { useLocation } from 'react-router-dom';\n\nimport Select from 'react-select';\nimport {\n  getExpensesCategory,\n  getIncomeCategory,\n  getSid,\n} from 'Redux/kapustaSlice';\nimport {\n  getExpenseCategories,\n  getIncomeCategories,\n} from 'Redux/transactionOperation';\nimport {\n  ErrorMessage,\n  ErrorPositionWrapper,\n} from '../DescriptionInput/DescriptionInput.styled';\nimport { colourStyles } from './CategoryInput.styled';\n\nexport default function CategoryInput() {\n  const { pathname } = useLocation();\n  const dispatch = useDispatch();\n  const expensCategory = useSelector(getExpensesCategory);\n  const incomeCategory = useSelector(getIncomeCategory);\n  const sid = useSelector(getSid);\n\n  useEffect(() => {\n    if (sid && pathname === '/home/expenses') dispatch(getExpenseCategories());\n\n    if (sid && pathname === '/home/income') dispatch(getIncomeCategories());\n  }, [dispatch, pathname, sid]);\n\n  const {\n    control,\n    formState: { errors },\n  } = useFormContext();\n\n  const categories = () => {\n    if (pathname === '/home/expenses')\n      return expensCategory?.map(i => ({ label: i, value: i }));\n\n    if (pathname === '/home/income')\n      return incomeCategory?.map(i => ({ label: i, value: i }));\n  };\n\n  return (\n    <>\n      <ErrorPositionWrapper>\n        <Controller\n          control={control}\n          name=\"category\"\n          render={({ field: { onChange, value, ref } }) => {\n            return (\n              <Select\n                ref={ref}\n                styles={colourStyles}\n                placeholder={'Product category'}\n                options={categories()}\n                value={value ? categories().find(c => c.value === value) : null}\n                onChange={val => onChange(val.value)}\n              />\n            );\n          }}\n        />\n        {errors?.category && (\n          <ErrorMessage>{errors?.category?.message || 'Error!'}</ErrorMessage>\n        )}\n      </ErrorPositionWrapper>\n    </>\n  );\n}\n"],"mappings":"AAAA,OAASA,SAAS,KAAQ,OAAO,CACjC,OAASC,UAAU,CAAEC,cAAc,KAAQ,iBAAiB,CAC5D,OAASC,WAAW,CAAEC,WAAW,KAAQ,aAAa,CACtD,OAASC,WAAW,KAAQ,kBAAkB,CAE9C,MAAOC,OAAM,KAAM,cAAc,CACjC,OACEC,mBAAmB,CACnBC,iBAAiB,CACjBC,MAAM,KACD,oBAAoB,CAC3B,OACEC,oBAAoB,CACpBC,mBAAmB,KACd,4BAA4B,CACnC,OACEC,YAAY,CACZC,oBAAoB,KACf,6CAA6C,CACpD,OAASC,YAAY,KAAQ,wBAAwB,CAAC,6IAEtD,cAAe,SAASC,cAAa,EAAG,sBACtC,iBAAqBV,WAAW,EAAE,CAA1BW,QAAQ,cAARA,QAAQ,CAChB,GAAMC,SAAQ,CAAGd,WAAW,EAAE,CAC9B,GAAMe,eAAc,CAAGd,WAAW,CAACG,mBAAmB,CAAC,CACvD,GAAMY,eAAc,CAAGf,WAAW,CAACI,iBAAiB,CAAC,CACrD,GAAMY,IAAG,CAAGhB,WAAW,CAACK,MAAM,CAAC,CAE/BT,SAAS,CAAC,UAAM,CACd,GAAIoB,GAAG,EAAIJ,QAAQ,GAAK,gBAAgB,CAAEC,QAAQ,CAACP,oBAAoB,EAAE,CAAC,CAE1E,GAAIU,GAAG,EAAIJ,QAAQ,GAAK,cAAc,CAAEC,QAAQ,CAACN,mBAAmB,EAAE,CAAC,CACzE,CAAC,CAAE,CAACM,QAAQ,CAAED,QAAQ,CAAEI,GAAG,CAAC,CAAC,CAE7B,oBAGIlB,cAAc,EAAE,CAFlBmB,OAAO,iBAAPA,OAAO,CACMC,MAAM,iBAAnBC,SAAS,CAAID,MAAM,CAGrB,GAAME,WAAU,CAAG,QAAbA,WAAU,EAAS,CACvB,GAAIR,QAAQ,GAAK,gBAAgB,CAC/B,MAAOE,eAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAEO,GAAG,CAAC,SAAAC,CAAC,QAAK,CAAEC,KAAK,CAAED,CAAC,CAAEE,KAAK,CAAEF,CAAE,CAAC,EAAC,CAAC,CAE3D,GAAIV,QAAQ,GAAK,cAAc,CAC7B,MAAOG,eAAc,SAAdA,cAAc,iBAAdA,cAAc,CAAEM,GAAG,CAAC,SAAAC,CAAC,QAAK,CAAEC,KAAK,CAAED,CAAC,CAAEE,KAAK,CAAEF,CAAE,CAAC,EAAC,CAAC,CAC7D,CAAC,CAED,mBACE,sCACE,MAAC,oBAAoB,yBACnB,KAAC,UAAU,EACT,OAAO,CAAEL,OAAQ,CACjB,IAAI,CAAC,UAAU,CACf,MAAM,CAAE,qBAAyC,qBAAtCQ,KAAK,CAAIC,SAAQ,YAARA,QAAQ,CAAEF,KAAK,YAALA,KAAK,CAAEG,GAAG,YAAHA,GAAG,CACtC,mBACE,KAAC,MAAM,EACL,GAAG,CAAEA,GAAI,CACT,MAAM,CAAEjB,YAAa,CACrB,WAAW,CAAE,kBAAmB,CAChC,OAAO,CAAEU,UAAU,EAAG,CACtB,KAAK,CAAEI,KAAK,CAAGJ,UAAU,EAAE,CAACQ,IAAI,CAAC,SAAAC,CAAC,QAAIA,EAAC,CAACL,KAAK,GAAKA,KAAK,GAAC,CAAG,IAAK,CAChE,QAAQ,CAAE,kBAAAM,GAAG,QAAIJ,UAAQ,CAACI,GAAG,CAACN,KAAK,CAAC,EAAC,EACrC,CAEN,CAAE,EACF,CACD,CAAAN,MAAM,SAANA,MAAM,iBAANA,MAAM,CAAEa,QAAQ,gBACf,KAAC,YAAY,WAAE,CAAAb,MAAM,SAANA,MAAM,mCAANA,MAAM,CAAEa,QAAQ,2CAAhB,iBAAkBC,OAAO,GAAI,QAAQ,EACrD,GACoB,EACtB,CAEP"},"metadata":{},"sourceType":"module"}